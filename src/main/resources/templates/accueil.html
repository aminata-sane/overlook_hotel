<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overlook Hotel - Accueil</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #f39c12;
            --light-bg: #ecf0f1;
            --dark-bg: #34495e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }

        .hero-section {
            background: linear-gradient(rgba(44, 62, 80, 0.8), rgba(44, 62, 80, 0.8)), 
                        url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            height: 100vh;
            display: flex;
            align-items: center;
            color: white;
            position: relative;
        }

        .hero-content {
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .hero-subtitle {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        .search-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-top: 3rem;
        }

        .search-card h3 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            padding: 12px 15px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 0.2rem rgba(243, 156, 18, 0.25);
        }

        .btn-search {
            background: linear-gradient(45deg, var(--secondary-color), var(--accent-color));
            border: none;
            border-radius: 10px;
            padding: 12px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .btn-search:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
            color: white;
        }

        .features-section {
            padding: 80px 0;
            background: var(--light-bg);
        }

        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 40px 30px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .feature-icon {
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 1.5rem;
        }

        .rooms-section {
            padding: 80px 0;
        }

        .room-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 25px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            height: 100%;
        }

        .room-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .room-image {
            height: 250px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .room-price {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--secondary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 25px;
            font-weight: 600;
        }

        .room-content {
            padding: 25px;
        }

        .room-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .room-features {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }

        .room-feature {
            background: var(--light-bg);
            color: var(--primary-color);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .room-basic-info {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .amenities-title {
            color: var(--primary-color);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .room-toggle-btn {
            color: var(--accent-color) !important;
            font-size: 0.9rem;
            font-weight: 500;
            text-decoration: none !important;
            transition: all 0.3s ease;
            border: none !important;
            box-shadow: none !important;
        }

        .room-toggle-btn:hover {
            color: var(--secondary-color) !important;
            transform: translateX(5px);
        }

        .room-toggle-btn i {
            transition: transform 0.3s ease;
        }

        .room-toggle-btn[aria-expanded="true"] i {
            transform: rotate(180deg);
        }

        .room-details-collapse {
            border-left: 3px solid var(--accent-color);
            margin-left: 15px;
        }

        .room-details-content {
            padding-left: 15px;
            background: rgba(243, 156, 18, 0.05);
            border-radius: 8px;
            padding: 12px 15px;
        }

        .description-title {
            color: var(--primary-color);
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .room-description {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 0;
            text-align: justify;
        }

        .navbar-custom {
            background: rgba(44, 62, 80, 0.95) !important;
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .navbar-brand {
            font-size: 1.8rem;
            font-weight: 700;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 2rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(-10px); }
            60% { transform: translateX(-50%) translateY(-5px); }
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 3rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(45deg, var(--secondary-color), var(--accent-color));
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-hotel"></i> Overlook Hotel
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#accueil">Accueil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#chambres">Chambres</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#services">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/panier">
                            <i class="fas fa-shopping-cart"></i> Panier
                            <span id="panier-count" class="badge bg-danger ms-1">0</span>
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/connexion">
                            <i class="fas fa-sign-in-alt"></i> Connexion Client
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="proDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-cog"></i> Espace Professionnel
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/portail">
                                <i class="fas fa-hotel"></i> Portail Professionnel
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="/employe">
                                <i class="fas fa-user-tie"></i> Accès Employé
                            </a></li>
                            <li><a class="dropdown-item" href="/gestionnaire">
                                <i class="fas fa-user-cog"></i> Accès Gestionnaire
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="accueil" class="hero-section">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Overlook Hotel</h1>
                <p class="hero-subtitle">Découvrez l'élégance et le luxe dans un cadre exceptionnel</p>
                
                <!-- Formulaire de recherche -->
                <div class="search-card">
                    <h3><i class="fas fa-search"></i> Trouvez votre chambre idéale</h3>
                    <form th:action="@{/rechercher-chambres}" method="post" th:object="${reservation}">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label for="dateArrivee" class="form-label">
                                    <i class="fas fa-calendar-alt"></i> Date d'arrivée
                                </label>
                                <input type="date" class="form-control" id="dateArrivee" 
                                       th:field="*{dateArrivee}" th:min="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="dateDepart" class="form-label">
                                    <i class="fas fa-calendar-alt"></i> Date de départ
                                </label>
                                <input type="date" class="form-control" id="dateDepart" 
                                       th:field="*{dateDepart}" th:min="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}" required>
                            </div>
                            <div class="col-md-6">
                                <label for="nombreAdultes" class="form-label">
                                    <i class="fas fa-user"></i> Adultes
                                </label>
                                <select class="form-select" id="nombreAdultes" th:field="*{nombreAdultes}" required>
                                    <option value="">Nombre d'adultes</option>
                                    <option value="1">1 adulte</option>
                                    <option value="2">2 adultes</option>
                                    <option value="3">3 adultes</option>
                                    <option value="4">4 adultes</option>
                                    <option value="5">5 adultes</option>
                                    <option value="6">6 adultes</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="nombreEnfants" class="form-label">
                                    <i class="fas fa-child"></i> Enfants
                                </label>
                                <select class="form-select" id="nombreEnfants" th:field="*{nombreEnfants}">
                                    <option value="0">Aucun enfant</option>
                                    <option value="1">1 enfant</option>
                                    <option value="2">2 enfants</option>
                                    <option value="3">3 enfants</option>
                                    <option value="4">4 enfants</option>
                                </select>
                            </div>
                            <div class="col-12 text-center">
                                <button type="submit" class="btn btn-search btn-lg">
                                    <i class="fas fa-search"></i> Rechercher des chambres
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="scroll-indicator">
            <i class="fas fa-chevron-down"></i>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="features-section">
        <div class="container">
            <h2 class="section-title">Nos Services d'Exception</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-spa"></i>
                        </div>
                        <h4>Spa & Bien-être</h4>
                        <p>Détendez-vous dans notre spa luxueux avec jacuzzi, massage et soins personnalisés.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <h4>Restaurant Gastronomique</h4>
                        <p>Savourez une cuisine raffinée préparée par nos chefs étoilés dans un cadre élégant.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-concierge-bell"></i>
                        </div>
                        <h4>Service Conciergerie</h4>
                        <p>Notre équipe dédiée est à votre disposition 24h/24 pour tous vos besoins.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Chambres en vedette -->
    <section id="chambres" class="rooms-section">
        <div class="container">
            <h2 class="section-title">Nos Chambres d'Exception</h2>
            <div class="row g-4">
                <div class="col-lg-4" th:each="chambre : ${chambresVedette}">
                    <div class="room-card">
                        <div class="room-image" th:style="'background-image: url(' + ${chambre.imageUrl != null ? chambre.imageUrl : (chambre.type.name() == 'SIMPLE' ? 'https://images.unsplash.com/photo-1618773928121-c32242e63f39?ixlib=rb-4.0.3&amp;auto=format&amp;fit=crop&amp;w=1000&amp;q=80' : chambre.type.name() == 'DOUBLE' ? 'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?ixlib=rb-4.0.3&amp;auto=format&amp;fit=crop&amp;w=1000&amp;q=80' : chambre.type.name() == 'SUITE' ? 'https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?ixlib=rb-4.0.3&amp;auto=format&amp;fit=crop&amp;w=1000&amp;q=80' : chambre.type.name() == 'FAMILIALE' ? 'https://images.unsplash.com/photo-1571003123894-1f0594d2b5d9?ixlib=rb-4.0.3&amp;auto=format&amp;fit=crop&amp;w=1000&amp;q=80' : chambre.type.name() == 'DELUXE' ? 'https://images.unsplash.com/photo-1591088398332-8a7791972843?ixlib=rb-4.0.3&amp;auto=format&amp;fit=crop&amp;w=1000&amp;q=80' : 'https://images.unsplash.com/photo-1566665797739-1674de7a421a?ixlib=rb-4.0.3&amp;auto=format&amp;fit=crop&amp;w=1000&amp;q=80')} + ')'">
                            <div class="room-price" th:text="${chambre.prix} + '€/nuit'"></div>
                        </div>
                        <div class="room-content">
                            <h5 class="room-title" th:text="${chambre.description != null and chambre.description.contains(' - ') ? chambre.description.substring(0, chambre.description.indexOf(' - ')) : 'Chambre ' + chambre.type.libelle + ' - ' + chambre.numero}"></h5>
                            
                            <!-- Informations de base -->
                            <div class="room-basic-info mb-3">
                                <span class="room-feature">
                                    <i class="fas fa-users"></i> <span th:text="${chambre.capacite} + ' personnes'"></span>
                                </span>
                                <span class="room-feature">
                                    <i class="fas fa-euro-sign"></i> <span th:text="${chambre.prix} + '€/nuit'"></span>
                                </span>
                            </div>
                            
                            <!-- Équipements et options incluses -->
                            <div class="room-amenities mb-3">
                                <h6 class="amenities-title">Options incluses :</h6>
                                <div class="room-features">
                                    <span class="room-feature" th:each="equipement : ${chambre.equipements}" th:text="${equipement.libelle}"></span>
                                </div>
                            </div>
                            
                            <!-- Menu déroulant pour le descriptif -->
                            <div class="room-details-toggle mb-3">
                                <button class="btn btn-link p-0 text-start room-toggle-btn" type="button" 
                                        data-bs-toggle="collapse" th:attr="data-bs-target='#roomDetails' + ${chambre.id}"
                                        aria-expanded="false">
                                    <i class="fas fa-chevron-down me-1"></i> Voir les détails
                                </button>
                                
                                <div class="collapse room-details-collapse" th:id="'roomDetails' + ${chambre.id}">
                                    <div class="room-details-content mt-2">
                                        <h6 class="description-title">Description détaillée :</h6>
                                        <p class="room-description" 
                                           th:text="${chambre.description != null ? chambre.description : 'Cette chambre spacieuse offre tout le confort moderne dans un cadre élégant. Elle dispose d''une décoration soignée, d''un mobilier de qualité et d''une ambiance chaleureuse. Profitez d''un séjour relaxant avec vue panoramique, literie premium et services personnalisés pour une expérience inoubliable.'}"></p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <a th:href="@{'/reservation/chambre/' + ${chambre.id}}" class="btn btn-search">
                                    <i class="fas fa-calendar-check"></i> Réserver maintenant
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-5">
                <a href="/chambres" class="btn btn-outline-primary btn-lg">
                    <i class="fas fa-bed"></i> Voir toutes nos chambres
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5><i class="fas fa-hotel"></i> Overlook Hotel</h5>
                    <p>Un hôtel d'exception pour des moments inoubliables.</p>
                </div>
                <div class="col-md-4">
                    <h5>Contact</h5>
                    <p><i class="fas fa-phone"></i> +33 1 23 45 67 89</p>
                    <p><i class="fas fa-envelope"></i> contact@overlook-hotel.com</p>
                </div>
                <div class="col-md-4">
                    <h5>Suivez-nous</h5>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-white"><i class="fab fa-facebook fa-2x"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-instagram fa-2x"></i></a>
                        <a href="#" class="text-white"><i class="fab fa-twitter fa-2x"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Animation du navbar au scroll
        window.addEventListener('scroll', function() {
            const navbar = document.querySelector('.navbar-custom');
            if (window.scrollY > 50) {
                navbar.style.background = 'rgba(44, 62, 80, 0.98)';
            } else {
                navbar.style.background = 'rgba(44, 62, 80, 0.95)';
            }
        });

        // Validation des dates
        document.getElementById('dateArrivee').addEventListener('change', function() {
            const dateArrivee = this.value;
            const dateDepart = document.getElementById('dateDepart');
            dateDepart.min = dateArrivee;
            
            if (dateDepart.value && dateDepart.value <= dateArrivee) {
                dateDepart.value = '';
            }
        });

        // Gestion des menus déroulants des chambres
        document.addEventListener('DOMContentLoaded', function() {
            const collapseElements = document.querySelectorAll('.room-details-collapse');
            
            collapseElements.forEach(collapse => {
                const toggleButton = document.querySelector(`[data-bs-target="#${collapse.id}"]`);
                
                collapse.addEventListener('show.bs.collapse', function() {
                    if (toggleButton) {
                        toggleButton.innerHTML = '<i class="fas fa-chevron-up me-1"></i> Voir moins';
                    }
                });
                
                collapse.addEventListener('hide.bs.collapse', function() {
                    if (toggleButton) {
                        toggleButton.innerHTML = '<i class="fas fa-chevron-down me-1"></i> Voir plus';
                    }
                });
            });
        });

        // Gestion du panier
        let cartCount = 0;
        let cartTotal = 0;

        function chargerCompteurPanier() {
            fetch('/panier/compteur', {
                method: 'GET',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                cartCount = data.nombreItems;
                cartTotal = data.prixTotal;
                mettreAJourIndicateurPanier();
            })
            .catch(error => {
                console.log('Erreur lors du chargement du compteur panier:', error);
            });
        }

        function mettreAJourIndicateurPanier() {
            const cartIndicator = document.getElementById('cart-indicator');
            const cartCountElement = document.getElementById('cart-count');
            
            if (cartCount > 0) {
                cartIndicator.style.display = 'block';
                cartCountElement.textContent = cartCount;
            } else {
                cartIndicator.style.display = 'none';
            }
        }

        // Charger le compteur au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            chargerCompteurPanier();
        });
    </script>

    <!-- Indicateur de panier fixe -->
    <div id="cart-indicator" style="position: fixed; top: 20px; right: 20px; z-index: 1050; display: none;">
        <a href="/panier" class="btn btn-primary rounded-pill shadow">
            <i class="fas fa-shopping-cart"></i>
            <span class="badge bg-danger ms-1" id="cart-count">0</span>
        </a>
    </div>
</body>
</html>
